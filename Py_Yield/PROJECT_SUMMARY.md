# Wafer Yield Analyzer - å°ˆæ¡ˆç¸½çµ

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
C:\Py_Yield\
â”œâ”€â”€ wafer_yield_analyzer.py          # ä¸»ç¨‹å¼ï¼ˆç°¡æ˜“ç‰ˆï¼‰
â”œâ”€â”€ wafer_yield_analyzer_advanced.py # é€²éšç‰ˆï¼ˆæ”¯æ´YAMLé…ç½®ï¼‰
â”œâ”€â”€ example_usage.py                 # ä½¿ç”¨ç¯„ä¾‹
â”œâ”€â”€ test_wafer_analyzer.py           # å–®å…ƒæ¸¬è©¦
â”œâ”€â”€ config.yaml                      # é…ç½®æª”æ¡ˆ
â”œâ”€â”€ requirements.txt                 # Pythonä¾è³´å¥—ä»¶
â”œâ”€â”€ pyproject.toml                   # ç¾ä»£åŒ–Pythonå°ˆæ¡ˆé…ç½®
â”œâ”€â”€ run_analysis.bat                 # Windowsæ‰¹æ¬¡åŸ·è¡Œè…³æœ¬
â”œâ”€â”€ README.md                        # å®Œæ•´å°ˆæ¡ˆæ–‡ä»¶
â”œâ”€â”€ QUICKSTART.md                    # å¿«é€Ÿå…¥é–€æŒ‡å—
â”œâ”€â”€ PROJECT_SUMMARY.md               # å°ˆæ¡ˆç¸½çµï¼ˆæœ¬æª”æ¡ˆï¼‰
â””â”€â”€ .gitignore                       # Gitå¿½ç•¥æª”æ¡ˆé…ç½®
```

## ğŸ¯ å°ˆæ¡ˆç›®çš„

æœ¬å°ˆæ¡ˆæ—¨åœ¨è‡ªå‹•åŒ–æ™¶åœ“è‰¯ç‡åˆ†ææµç¨‹ï¼š
1. æƒææŒ‡å®šç›®éŒ„ä¸­æ‰€æœ‰åŒ…å« "Wafer_Summary" çš„ Excel æª”æ¡ˆ
2. å¾æ¯å€‹æª”æ¡ˆä¸­æå– Wafer IDï¼ˆB4å„²å­˜æ ¼ï¼‰å’Œ Yieldï¼ˆD11å„²å­˜æ ¼ï¼‰
3. ç”Ÿæˆç¾è§€çš„æŠ˜ç·šåœ–å±•ç¤ºè‰¯ç‡è¶¨å‹¢
4. è¼¸å‡ºåŒ…å«æ•¸æ“šè¡¨æ ¼å’Œåœ–è¡¨çš„ Excel å ±å‘Š

## ğŸš€ å¿«é€Ÿé–‹å§‹

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨æ‰¹æ¬¡è…³æœ¬ï¼ˆæ¨è–¦çµ¦Windowsä½¿ç”¨è€…ï¼‰

é›™æ“Š `run_analysis.bat` æª”æ¡ˆå³å¯è‡ªå‹•ï¼š
- æª¢æŸ¥Pythonç’°å¢ƒ
- å®‰è£å¿…è¦å¥—ä»¶
- åŸ·è¡Œåˆ†æç¨‹å¼
- é¡¯ç¤ºåŸ·è¡Œçµæœ

### æ–¹æ³•äºŒï¼šä½¿ç”¨å‘½ä»¤åˆ—

```bash
# 1. å®‰è£ä¾è³´å¥—ä»¶
pip install -r requirements.txt

# 2. åŸ·è¡ŒåŸºç¤ç‰ˆæœ¬
python wafer_yield_analyzer.py

# 3. æˆ–åŸ·è¡Œé€²éšç‰ˆæœ¬ï¼ˆä½¿ç”¨config.yamlé…ç½®ï¼‰
python wafer_yield_analyzer_advanced.py
```

### æ–¹æ³•ä¸‰ï¼šè‡ªè¨‚åŒ–åŸ·è¡Œ

```python
# ä½¿ç”¨ example_usage.py ä½œç‚ºç¯„æœ¬
python example_usage.py
```

## ğŸ“š æª”æ¡ˆèªªæ˜

### æ ¸å¿ƒç¨‹å¼æª”æ¡ˆ

#### 1. `wafer_yield_analyzer.py` - åŸºç¤ç‰ˆæœ¬
- **ç‰¹é»**ï¼šç°¡å–®æ˜“ç”¨ï¼Œé–‹ç®±å³ç”¨
- **é©ç”¨å ´æ™¯**ï¼šå¿«é€Ÿåˆ†æï¼Œä¸éœ€è¦è¤‡é›œé…ç½®
- **ä¿®æ”¹æ–¹å¼**ï¼šç›´æ¥ä¿®æ”¹ç¨‹å¼ä¸­çš„è®Šæ•¸

**ä¸»è¦åŠŸèƒ½ï¼š**
```python
def find_wafer_summary_files(directory: str) -> List[Path]
    # æœå°‹åŒ…å« "Wafer_Summary" çš„ Excel æª”æ¡ˆ

def extract_wafer_data(file_path: Path) -> Tuple[str, float]
    # å¾B4å’ŒD11å„²å­˜æ ¼æå–æ•¸æ“š

def create_yield_dataframe(files: List[Path]) -> pd.DataFrame
    # å»ºç«‹DataFrameæ•´ç†æ•¸æ“š

def create_beautiful_plot(df: pd.DataFrame, output_image: str) -> None
    # ç”Ÿæˆç¾è§€çš„æŠ˜ç·šåœ–

def save_to_excel_with_chart(...) -> None
    # å„²å­˜ç‚ºExcelæª”æ¡ˆä¸¦åµŒå…¥åœ–è¡¨
```

#### 2. `wafer_yield_analyzer_advanced.py` - é€²éšç‰ˆæœ¬
- **ç‰¹é»**ï¼šæ”¯æ´YAMLé…ç½®æª”æ¡ˆï¼Œé«˜åº¦å¯è‡ªè¨‚
- **é©ç”¨å ´æ™¯**ï¼šéœ€è¦é »ç¹èª¿æ•´åƒæ•¸ï¼Œæ‰¹æ¬¡è™•ç†å¤šå€‹å°ˆæ¡ˆ
- **ä¿®æ”¹æ–¹å¼**ï¼šç·¨è¼¯ `config.yaml` æª”æ¡ˆ

**é¡å¤–åŠŸèƒ½ï¼š**
- YAMLé…ç½®æª”æ¡ˆæ”¯æ´
- æ›´è©³ç´°çš„æ—¥èªŒè¨˜éŒ„
- å¯é…ç½®çš„å„²å­˜æ ¼ä½ç½®
- å¯é…ç½®çš„åœ–è¡¨æ¨£å¼
- æ•¸æ“šé©—è­‰åŠŸèƒ½

### é…ç½®æª”æ¡ˆ

#### `config.yaml` - é…ç½®ç¯„æœ¬
åŒ…å«æ‰€æœ‰å¯èª¿æ•´çš„åƒæ•¸ï¼š

```yaml
input:
  source_directory: "C:\\Users\\andrel52"  # ä¾†æºç›®éŒ„
  wafer_id_cell: "B4"                      # Wafer IDä½ç½®
  yield_cell: "D11"                        # Yieldä½ç½®
  file_pattern: "Wafer_Summary"            # æª”æ¡ˆåç¨±æ¨¡å¼

output:
  excel_filename: "wafer_yield_report.xlsx"
  chart_filename: "wafer_yield_chart.png"

visualization:
  figure_size:
    width: 14
    height: 8
  dpi: 300
  line:
    color: "#2E86AB"
    width: 2.5
  # ... æ›´å¤šé…ç½®é¸é …
```

### æ¸¬è©¦æª”æ¡ˆ

#### `test_wafer_analyzer.py` - å–®å…ƒæ¸¬è©¦
- åŒ…å«å®Œæ•´çš„å–®å…ƒæ¸¬è©¦å’Œæ•´åˆæ¸¬è©¦
- æ¸¬è©¦è¦†è“‹ç‡ç›®æ¨™ï¼š90%+
- ä½¿ç”¨ pytest æ¡†æ¶

**åŸ·è¡Œæ¸¬è©¦ï¼š**
```bash
# åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
pytest test_wafer_analyzer.py -v

# æŸ¥çœ‹æ¸¬è©¦è¦†è“‹ç‡
pytest --cov=wafer_yield_analyzer --cov-report=html
```

### ç¯„ä¾‹æª”æ¡ˆ

#### `example_usage.py` - ä½¿ç”¨ç¯„ä¾‹
å±•ç¤ºå¦‚ä½•ï¼š
- è‡ªè¨‚è¼¸å…¥ç›®éŒ„
- è‡ªè¨‚è¼¸å‡ºæª”æ¡ˆåç¨±
- æ‰¹æ¬¡è™•ç†å¤šå€‹ç›®éŒ„
- é¡¯ç¤ºçµ±è¨ˆè³‡è¨Š

### æ–‡ä»¶æª”æ¡ˆ

#### `README.md` - å®Œæ•´æ–‡ä»¶
- å°ˆæ¡ˆæ¦‚è¿°
- åŠŸèƒ½ç‰¹é»
- å®‰è£èªªæ˜
- ä½¿ç”¨æ–¹æ³•
- Excelæ ¼å¼è¦æ±‚
- éŒ¯èª¤è™•ç†

#### `QUICKSTART.md` - å¿«é€Ÿå…¥é–€
- å‰ç½®è¦æ±‚
- å®‰è£æ­¥é©Ÿ
- åŸ·è¡Œæ–¹æ³•
- å¸¸è¦‹å•é¡Œ
- é€²éšä½¿ç”¨æŠ€å·§

## ğŸ“Š è¼¸å‡ºæª”æ¡ˆ

åŸ·è¡Œåˆ†æå¾Œæœƒç”¢ç”Ÿï¼š

### 1. `wafer_yield_report.xlsx`
- **Yield Data å·¥ä½œè¡¨**ï¼šåŒ…å« Wafer ID å’Œ Yield æ•¸æ“šè¡¨æ ¼
- **Yield Chart å·¥ä½œè¡¨**ï¼šåµŒå…¥çš„é«˜è§£æåº¦æŠ˜ç·šåœ–

### 2. `wafer_yield_chart.png`
- ç¨ç«‹çš„åœ–è¡¨åœ–ç‰‡æª”æ¡ˆ
- è§£æåº¦ï¼š300 DPI
- æ ¼å¼ï¼šPNG

## ğŸ¨ åœ–è¡¨ç‰¹é»

### è¦–è¦ºè¨­è¨ˆ
- **é…è‰²æ–¹æ¡ˆ**ï¼šç¾ä»£åŒ–çš„è—ç´«è‰²èª¿
- **æ•¸æ“šæ¨™è¨˜**ï¼šæ¯å€‹æ•¸æ“šé»é¡¯ç¤ºç²¾ç¢ºç™¾åˆ†æ¯”
- **ç¶²æ ¼ç·š**ï¼šåŠé€æ˜æ ¼ç·šå”åŠ©è®€å–
- **èƒŒæ™¯è‰²**ï¼šæ·¡ç°è‰²èƒŒæ™¯æå‡å°æ¯”åº¦

### è‡ªè¨‚åŒ–é¸é …
å¯åœ¨ `config.yaml` æˆ–ç¨‹å¼ä¸­ä¿®æ”¹ï¼š
- ç·šæ¢é¡è‰²å’Œå¯¬åº¦
- æ¨™è¨˜å½¢ç‹€ã€å¤§å°ã€é¡è‰²
- å­—é«”å¤§å°
- åœ–è¡¨å°ºå¯¸
- è»¸æ¨™ç±¤å’Œæ¨™é¡Œ

## ğŸ”§ ä¾è³´å¥—ä»¶

### æ ¸å¿ƒå¥—ä»¶
```
pandas>=2.0.0      # æ•¸æ“šè™•ç†
openpyxl>=3.1.0    # Excelæª”æ¡ˆè®€å¯«
matplotlib>=3.7.0  # ç¹ªåœ–åŸºç¤åº«
seaborn>=0.12.0    # é€²éšè¦–è¦ºåŒ–
pyyaml>=6.0.0      # YAMLé…ç½®æª”æ¡ˆè§£æ
```

### é–‹ç™¼å¥—ä»¶ï¼ˆå¯é¸ï¼‰
```
pytest>=7.4.0      # æ¸¬è©¦æ¡†æ¶
pytest-cov>=4.1.0  # æ¸¬è©¦è¦†è“‹ç‡
ruff>=0.1.0        # ç¨‹å¼ç¢¼æ ¼å¼åŒ–å’Œæª¢æŸ¥
```

## ğŸ’¡ ä½¿ç”¨å ´æ™¯

### å ´æ™¯ä¸€ï¼šæ—¥å¸¸ç”Ÿç”¢ç›£æ§
```bash
# æ¯å¤©åŸ·è¡Œä¸€æ¬¡ï¼Œç›£æ§ç•¶æ—¥è‰¯ç‡
python wafer_yield_analyzer.py
```

### å ´æ™¯äºŒï¼šå¤šæ‰¹æ¬¡æ¯”è¼ƒ
```python
# æ‰¹æ¬¡è™•ç†ä¸åŒæ™‚æœŸçš„æ•¸æ“š
for quarter in ['Q1', 'Q2', 'Q3', 'Q4']:
    analyze_wafer_yield_custom(
        source_dir=f"C:\\WaferData\\2024-{quarter}",
        output_excel=f"yield_2024_{quarter}.xlsx"
    )
```

### å ´æ™¯ä¸‰ï¼šç ”ç™¼å¯¦é©—åˆ†æ
```yaml
# ä¿®æ”¹ config.yaml èª¿æ•´åƒæ•¸
input:
  source_directory: "C:\\R&D\\Experiment_001"
  file_pattern: "Test_Wafer"
```

## ğŸ” æ•¸æ“šè¦æ±‚

### Excelæª”æ¡ˆæ ¼å¼
```
å¿…å‚™æ¢ä»¶ï¼š
âœ“ æª”ååŒ…å« "Wafer_Summary"
âœ“ B4 å„²å­˜æ ¼æœ‰ Wafer ID
âœ“ D11 å„²å­˜æ ¼æœ‰ Yield æ•¸å€¼

æ”¯æ´çš„Yieldæ ¼å¼ï¼š
âœ“ ç™¾åˆ†æ¯”æ•¸å­—ï¼š95.5ï¼ˆä»£è¡¨95.5%ï¼‰
âœ“ ç™¾åˆ†æ¯”å­—ä¸²ï¼š"95.5%"
âœ“ å°æ•¸æ ¼å¼ï¼š0.955ï¼ˆè‡ªå‹•è½‰æ›ç‚º95.5%ï¼‰
```

### ç›®éŒ„çµæ§‹ç¯„ä¾‹
```
C:\Users\andrel52\
â”œâ”€â”€ Wafer_Summary_001.xlsx
â”œâ”€â”€ Wafer_Summary_002.xlsx
â”œâ”€â”€ Wafer_Summary_003.xlsx
â”œâ”€â”€ Other_File.xlsx          # æœƒè¢«å¿½ç•¥
â””â”€â”€ Reports\
    â””â”€â”€ Wafer_Summary_004.xlsx  # æœƒè¢«æ‰¾åˆ°ï¼ˆéè¿´æœå°‹ï¼‰
```

## âš™ï¸ é€²éšåŠŸèƒ½

### 1. éŒ¯èª¤å®¹éŒ¯æ©Ÿåˆ¶
```python
# è¨­å®šåœ¨ config.yaml
processing:
  skip_on_error: true  # é‡åˆ°éŒ¯èª¤è‡ªå‹•è·³éè©²æª”æ¡ˆ
  validate_yield_range: true  # é©—è­‰è‰¯ç‡ç¯„åœ
  min_yield: 0.0
  max_yield: 100.0
```

### 2. è‡ªè¨‚å„²å­˜æ ¼ä½ç½®
```yaml
# å¦‚æœæ‚¨çš„æ•¸æ“šåœ¨ä¸åŒå„²å­˜æ ¼
input:
  wafer_id_cell: "C5"   # æ”¹ç‚ºC5
  yield_cell: "E12"     # æ”¹ç‚ºE12
```

### 3. æ—¥èªŒè¨˜éŒ„
ç¨‹å¼åŸ·è¡Œæ™‚æœƒé¡¯ç¤ºè©³ç´°æ—¥èªŒï¼š
```
2024-11-14 10:00:00 - INFO - Starting Analysis...
2024-11-14 10:00:01 - INFO - Found 10 files
2024-11-14 10:00:02 - INFO - Extracted: W001, Yield=95.5%
2024-11-14 10:00:03 - WARNING - Skipping invalid_file.xlsx
2024-11-14 10:00:10 - INFO - âœ“ Completed successfully!
```

## ğŸ§ª æ¸¬è©¦å’Œå“è³ªä¿è­‰

### åŸ·è¡Œæ¸¬è©¦
```bash
# åŸºæœ¬æ¸¬è©¦
pytest test_wafer_analyzer.py

# è©³ç´°è¼¸å‡º
pytest test_wafer_analyzer.py -v

# æ¸¬è©¦è¦†è“‹ç‡å ±å‘Š
pytest --cov=wafer_yield_analyzer --cov-report=html
# ç„¶å¾Œé–‹å•Ÿ htmlcov/index.html æŸ¥çœ‹è©³ç´°å ±å‘Š
```

### ç¨‹å¼ç¢¼æ ¼å¼åŒ–
```bash
# ä½¿ç”¨ ruff æ ¼å¼åŒ–ç¨‹å¼ç¢¼
pip install ruff
ruff format .

# æª¢æŸ¥ç¨‹å¼ç¢¼å“è³ª
ruff check .
```

## ğŸ“ˆ æ•ˆèƒ½è€ƒé‡

### è™•ç†èƒ½åŠ›
- å–®æª”è™•ç†æ™‚é–“ï¼šç´„ 0.1-0.5 ç§’
- å»ºè­°æœ€å¤§æª”æ¡ˆæ•¸ï¼š1000 å€‹
- è¨˜æ†¶é«”éœ€æ±‚ï¼šåŸºæœ¬ï¼ˆ< 100MB for typical useï¼‰

### æœ€ä½³åŒ–å»ºè­°
- å°‡æª”æ¡ˆé›†ä¸­åœ¨åŒä¸€ç›®éŒ„
- é¿å…éæ·±çš„ç›®éŒ„çµæ§‹
- å®šæœŸæ¸…ç†èˆŠçš„è¼¸å‡ºæª”æ¡ˆ

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ

**å•é¡Œ1ï¼šæ‰¾ä¸åˆ°æ¨¡çµ„**
```bash
# è§£æ±ºï¼šé‡æ–°å®‰è£ä¾è³´
pip install -r requirements.txt --force-reinstall
```

**å•é¡Œ2ï¼šåœ–è¡¨ç„¡æ³•é¡¯ç¤ºä¸­æ–‡**
```python
# åœ¨ç¨‹å¼é–‹é ­åŠ å…¥
import matplotlib.pyplot as plt
plt.rcParams['font.sans-serif'] = ['Microsoft JhengHei']  # Windows
```

**å•é¡Œ3ï¼šExcelæª”æ¡ˆè¢«ä½”ç”¨**
```
# è§£æ±ºï¼šç¢ºä¿æ²’æœ‰å…¶ä»–ç¨‹å¼é–‹å•Ÿè¼¸å‡ºæª”æ¡ˆ
# æˆ–ä½¿ç”¨ä¸åŒçš„è¼¸å‡ºæª”å
```

## ğŸ“‹ æœ€ä½³å¯¦è¸

### 1. è³‡æ–™ç®¡ç†
- å®šæœŸå‚™ä»½åŸå§‹Excelæª”æ¡ˆ
- ä½¿ç”¨æœ‰æ„ç¾©çš„æª”æ¡ˆå‘½åè¦å‰‡
- å»ºç«‹æ—¥æœŸè³‡æ–™å¤¾çµ„ç¹”æ•¸æ“š

### 2. ç‰ˆæœ¬æ§åˆ¶
```bash
# ä½¿ç”¨ git è¿½è¹¤ç¨‹å¼è®Šæ›´
git init
git add *.py config.yaml
git commit -m "Initial commit"
```

### 3. è‡ªå‹•åŒ–åŸ·è¡Œ
ä½¿ç”¨ Windows å·¥ä½œæ’ç¨‹å™¨å®šæœŸåŸ·è¡Œï¼š
1. é–‹å•Ÿã€Œå·¥ä½œæ’ç¨‹å™¨ã€
2. å»ºç«‹åŸºæœ¬å·¥ä½œ
3. è¨­å®šè§¸ç™¼æ¢ä»¶ï¼ˆä¾‹å¦‚ï¼šæ¯æ—¥æ—©ä¸Š9é»ï¼‰
4. å‹•ä½œï¼šåŸ·è¡Œ `run_analysis.bat`

## ğŸ“ å­¸ç¿’è³‡æº

### Python åŸºç¤
- [Official Python Tutorial](https://docs.python.org/3/tutorial/)
- [Real Python](https://realpython.com/)

### è³‡æ–™åˆ†æ
- [Pandas Documentation](https://pandas.pydata.org/docs/)
- [Matplotlib Tutorials](https://matplotlib.org/stable/tutorials/index.html)

### æ¸¬è©¦
- [Pytest Documentation](https://docs.pytest.org/)

## ğŸ“ æˆæ¬Š

æœ¬å°ˆæ¡ˆæ¡ç”¨ MIT æˆæ¬Šï¼Œæ‚¨å¯ä»¥è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†ç™¼ã€‚

## ğŸ™ è²¢ç»

æ­¡è¿æäº¤å•é¡Œå ±å‘Šã€åŠŸèƒ½å»ºè­°æˆ–ç¨‹å¼ç¢¼è²¢ç»ï¼

## ğŸ“ æŠ€è¡“æ”¯æ´

é‡åˆ°å•é¡Œæ™‚ï¼š
1. æŸ¥çœ‹æ—¥èªŒè¼¸å‡º
2. åƒè€ƒ `QUICKSTART.md` çš„å¸¸è¦‹å•é¡Œ
3. åŸ·è¡Œæ¸¬è©¦ç¢ºèªç’°å¢ƒè¨­å®š
4. æª¢æŸ¥ Excel æª”æ¡ˆæ ¼å¼æ˜¯å¦æ­£ç¢º

---

**ç‰ˆæœ¬ï¼š** 1.0.0  
**æœ€å¾Œæ›´æ–°ï¼š** 2024-11-14  
**Pythonç‰ˆæœ¬è¦æ±‚ï¼š** 3.10+  
**ä½œè€…ï¼š** Your Name

