# å¿«é€Ÿå…¥é–€æŒ‡å—

## ğŸ“‹ å‰ç½®è¦æ±‚

- Python 3.10 æˆ–æ›´é«˜ç‰ˆæœ¬
- pipï¼ˆPython å¥—ä»¶ç®¡ç†å·¥å…·ï¼‰

## ğŸš€ å®‰è£æ­¥é©Ÿ

### 1. å®‰è£ä¾è³´å¥—ä»¶

é–‹å•Ÿçµ‚ç«¯æ©Ÿï¼ˆPowerShell æˆ– å‘½ä»¤æç¤ºå­—å…ƒï¼‰ï¼Œåˆ‡æ›åˆ°å°ˆæ¡ˆç›®éŒ„ï¼š

```bash
cd C:\Py_Yield
```

å®‰è£æ‰€éœ€å¥—ä»¶ï¼š

```bash
pip install -r requirements.txt
```

### 2. æº–å‚™æ‚¨çš„è³‡æ–™

ç¢ºä¿æ‚¨çš„ Excel æª”æ¡ˆç¬¦åˆä»¥ä¸‹æ ¼å¼ï¼š
- æª”æ¡ˆåç¨±åŒ…å« `Wafer_Summary`ï¼ˆä¾‹å¦‚ï¼š`Wafer_Summary_001.xlsx`ï¼‰
- **B4 å„²å­˜æ ¼**ï¼šå­˜æ”¾ Wafer IDï¼ˆæ™¶åœ“ç·¨è™Ÿï¼‰
- **D11 å„²å­˜æ ¼**ï¼šå­˜æ”¾ Yieldï¼ˆè‰¯ç‡ç™¾åˆ†æ¯”ï¼‰

ç¯„ä¾‹ï¼š
```
| A | B    | C | D    |
|---|------|---|------|
| 1 |      |   |      |
| 2 |      |   |      |
| 3 |      |   |      |
| 4 | W001 |   | 95.5 |  â† Wafer ID åœ¨ B4ï¼ŒYield åœ¨ D11
...
|11 |      |   | 95.5 |  â† Yield æ•¸å€¼
```

### 3. åŸ·è¡Œç¨‹å¼

**æ–¹æ³•ä¸€ï¼šä½¿ç”¨é è¨­è¨­å®š**

ç›´æ¥åŸ·è¡Œä¸»ç¨‹å¼ï¼š

```bash
python wafer_yield_analyzer.py
```

ç¨‹å¼æœƒï¼š
- æœå°‹ `C:\Users\andrel52` ç›®éŒ„ä¸‹æ‰€æœ‰åŒ…å« "Wafer_Summary" çš„ Excel æª”æ¡ˆ
- è‡ªå‹•æå–æ¯ç‰‡æ™¶åœ“çš„ ID å’Œè‰¯ç‡
- ç”Ÿæˆè¦–è¦ºåŒ–æŠ˜ç·šåœ–
- è¼¸å‡º Excel å ±å‘Š

**æ–¹æ³•äºŒï¼šè‡ªè¨‚è·¯å¾‘**

å¦‚æœæ‚¨çš„æª”æ¡ˆåœ¨å…¶ä»–ä½ç½®ï¼Œå¯ä»¥ç·¨è¼¯ `wafer_yield_analyzer.py`ï¼š

```python
# åœ¨ main() å‡½æ•¸ä¸­ä¿®æ”¹é€™ä¸€è¡Œ
source_directory = r"C:\Your\Custom\Path"  # æ”¹æˆæ‚¨çš„è·¯å¾‘
```

**æ–¹æ³•ä¸‰ï¼šä½¿ç”¨ç¯„ä¾‹ç¨‹å¼**

ä½¿ç”¨ `example_usage.py` ä¾†è‡ªè¨‚æ›´å¤šåƒæ•¸ï¼š

```python
analyze_wafer_yield_custom(
    source_dir=r"C:\Your\Path",
    output_excel="my_report.xlsx",
    output_image="my_chart.png"
)
```

åŸ·è¡Œï¼š

```bash
python example_usage.py
```

## ğŸ“Š æŸ¥çœ‹çµæœ

åŸ·è¡Œå®Œæˆå¾Œï¼Œæ‚¨æœƒåœ¨ç•¶å‰ç›®éŒ„çœ‹åˆ°ï¼š

1. **wafer_yield_report.xlsx** - Excel å ±å‘Š
   - "Yield Data" å·¥ä½œè¡¨ï¼šå®Œæ•´çš„è³‡æ–™è¡¨æ ¼
   - "Yield Chart" å·¥ä½œè¡¨ï¼šç¾è§€çš„æŠ˜ç·šåœ–

2. **wafer_yield_chart.png** - é«˜è§£æåº¦åœ–è¡¨ï¼ˆ300 DPIï¼‰

### Excel å ±å‘Šå…§å®¹

**Yield Data å·¥ä½œè¡¨ï¼š**
```
| Wafer_ID | Yield |
|----------|-------|
| W001     | 95.50 |
| W002     | 96.20 |
| W003     | 94.80 |
```

**Yield Chart å·¥ä½œè¡¨ï¼š**
- åµŒå…¥çš„æŠ˜ç·šåœ–ï¼ŒåŒ…å«ï¼š
  - Xè»¸ï¼šWafer ID
  - Yè»¸ï¼šYield (%)
  - æ¯å€‹æ•¸æ“šé»éƒ½æ¨™è¨»äº†ç²¾ç¢ºæ•¸å€¼
  - å°ˆæ¥­çš„é…è‰²å’Œæ ¼ç·š

## ğŸ§ª åŸ·è¡Œæ¸¬è©¦ï¼ˆå¯é¸ï¼‰

å¦‚æœæ‚¨æƒ³æ¸¬è©¦ç¨‹å¼åŠŸèƒ½ï¼š

```bash
pip install pytest pytest-cov
pytest test_wafer_analyzer.py -v
```

æŸ¥çœ‹æ¸¬è©¦è¦†è“‹ç‡ï¼š

```bash
pytest --cov=wafer_yield_analyzer --cov-report=html
```

## ğŸ”§ å¸¸è¦‹å•é¡Œ

### Q1: æ‰¾ä¸åˆ°æª”æ¡ˆ

**éŒ¯èª¤è¨Šæ¯ï¼š** `No Wafer_Summary files found`

**è§£æ±ºæ–¹æ³•ï¼š**
- ç¢ºèªæª”æ¡ˆåç¨±åŒ…å« "Wafer_Summary"
- æª¢æŸ¥è·¯å¾‘æ˜¯å¦æ­£ç¢º
- ç¢ºèªæª”æ¡ˆæ ¼å¼ç‚º `.xlsx` æˆ– `.xls`

### Q2: å„²å­˜æ ¼æ•¸æ“šç‚ºç©º

**éŒ¯èª¤è¨Šæ¯ï¼š** `Wafer ID (B4) is empty`

**è§£æ±ºæ–¹æ³•ï¼š**
- ç¢ºèª B4 å„²å­˜æ ¼æœ‰ Wafer ID
- ç¢ºèª D11 å„²å­˜æ ¼æœ‰è‰¯ç‡æ•¸å€¼
- æª¢æŸ¥å·¥ä½œè¡¨æ˜¯å¦ç‚ºç¬¬ä¸€å€‹å·¥ä½œè¡¨ï¼ˆactive sheetï¼‰

### Q3: è‰¯ç‡æ•¸å€¼æ ¼å¼éŒ¯èª¤

ç¨‹å¼æ”¯æ´å¤šç¨®æ ¼å¼ï¼š
- ç™¾åˆ†æ¯”æ•¸å­—ï¼š`95.5`ï¼ˆä»£è¡¨ 95.5%ï¼‰
- ç™¾åˆ†æ¯”å­—ä¸²ï¼š`"95.5%"`
- å°æ•¸æ ¼å¼ï¼š`0.955`ï¼ˆè‡ªå‹•è½‰æ›ç‚º 95.5%ï¼‰

### Q4: è¨˜æ†¶é«”ä¸è¶³

å¦‚æœè™•ç†å¤§é‡æª”æ¡ˆï¼š
- ç¢ºä¿æœ‰è¶³å¤ çš„ RAM
- è€ƒæ…®åˆ†æ‰¹è™•ç†æª”æ¡ˆ

## ğŸ“ ç¨‹å¼æ—¥èªŒ

åŸ·è¡Œæ™‚æœƒé¡¯ç¤ºè©³ç´°æ—¥èªŒï¼š

```
2024-11-14 10:00:00 - INFO - Starting Wafer Yield Analysis...
2024-11-14 10:00:01 - INFO - Found 10 Wafer_Summary files
2024-11-14 10:00:02 - INFO - Extracted data from Wafer_Summary_001.xlsx: ID=W001, Yield=95.5%
...
2024-11-14 10:00:10 - INFO - âœ“ Analysis completed successfully!
```

## ğŸ’¡ é€²éšä½¿ç”¨

### æ‰¹æ¬¡è™•ç†å¤šå€‹ç›®éŒ„

```python
directories = [
    r"C:\WaferData\2024-Q1",
    r"C:\WaferData\2024-Q2",
    r"C:\WaferData\2024-Q3",
]

for dir_path in directories:
    analyze_wafer_yield_custom(
        source_dir=dir_path,
        output_excel=f"report_{Path(dir_path).name}.xlsx",
        output_image=f"chart_{Path(dir_path).name}.png"
    )
```

### è‡ªè¨‚åœ–è¡¨æ¨£å¼

æ‚¨å¯ä»¥ä¿®æ”¹ `create_beautiful_plot()` å‡½æ•¸ä¸­çš„åƒæ•¸ä¾†èª¿æ•´åœ–è¡¨å¤–è§€ï¼š
- é¡è‰²ï¼šä¿®æ”¹ `color` å’Œ `markerfacecolor`
- æ¨™è¨˜å¤§å°ï¼šèª¿æ•´ `markersize`
- ç·šæ¢å¯¬åº¦ï¼šèª¿æ•´ `linewidth`
- åœ–è¡¨å°ºå¯¸ï¼šä¿®æ”¹ `figsize`

## ğŸ†˜ éœ€è¦å”åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°å•é¡Œï¼š
1. æª¢æŸ¥éŒ¯èª¤è¨Šæ¯
2. ç¢ºèª Excel æª”æ¡ˆæ ¼å¼
3. æŸ¥çœ‹æ—¥èªŒè¼¸å‡º
4. åŸ·è¡Œæ¸¬è©¦ç¢ºèªç’°å¢ƒè¨­å®šæ­£ç¢º

## ğŸ“š ç›¸é—œæª”æ¡ˆ

- `wafer_yield_analyzer.py` - ä¸»ç¨‹å¼
- `example_usage.py` - ä½¿ç”¨ç¯„ä¾‹
- `test_wafer_analyzer.py` - å–®å…ƒæ¸¬è©¦
- `requirements.txt` - ä¾è³´å¥—ä»¶æ¸…å–®
- `README.md` - å®Œæ•´æ–‡ä»¶

